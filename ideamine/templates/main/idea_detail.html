{% extends "main.html" %}
{% load comments %}

{% block title %}{{ object.short_name|title }}{% endblock %}

{% block content %}
{% if form %}
<form action="{% url idea_update object.pk %}" method="post">
  <table>
	{{ form.as_table }}
  </table>
  {% csrf_token %}
  <input type="submit" value="Update Idea">
</form>
{% else %}
<h2>{{ object.short_name|title }}</h2>
<table>
  <tr>
	<th>Owner:</th>
	<td><a href="{% url user_detail object.owner.user.id %}">{{ object.owner }}</a></td>
  </tr>
  <tr>
	<th>Created:</th>
	<td>{{ object.created_at }}</td>
  </tr>
  <tr>
	<th>Tags:</th>
	<td><ul>{{ object.tags.all|unordered_list }}</ul></td>
  </tr>
  <tr>
	<th>Current Members:</th>
	<td>{{ object.members.all.count }}</td>
  </tr>
</table>
{% endif %}
{% if user.get_profile == object.owner %}

{% with object.unconfirmed_members as object_list %}
{% with True as edit %}
{% include 'auth/user_table.html' %}
{% endwith %}{% endwith %}

{% else %}

{% if not user.get_profile in object.members.all %}
<form method = "post" action = "{% url user_join_idea object.pk %}">
  {% csrf_token %}
  <input type = "submit" value = "Join Project" />
</form>
{% else %}
<form method = "post" action = "{% url user_leave_idea object.pk %}">
  {% csrf_token %}
  <input type = "submit" value = "Leave Project" />
</form>
{% endif %}

{% endif %}

<h3>Description</h3>
<p>{{ object.desc }}</p>

<h3>Comments</h3>
{% render_comment_list for object %}
{% if user.is_authenticated %}
{% render_comment_form for object %}
{% endif %}
{% endblock %}
